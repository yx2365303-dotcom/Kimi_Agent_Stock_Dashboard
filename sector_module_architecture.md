# 板块热点模块架构图

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                              板块热点模块架构                                     │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                 │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          前端展示层                                       │   │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │   │
│  │  │  板块热力图   │ │  板块排行    │ │  轮动分析    │ │  关联图谱    │   │   │
│  │  │  (Treemap)   │ │  (List)      │ │  (Charts)    │ │  (Graph)     │   │   │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘   │   │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │   │
│  │  │  资金流向    │ │  开盘啦题材  │ │  最强板块    │ │  板块详情    │   │   │
│  │  │  (Chart)     │ │  (Panel)     │ │  (Stats)     │ │  (Modal)     │   │   │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                            │
│                                    ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          API接口层                                        │   │
│  │  /api/sectors          /api/sectors/rank      /api/sectors/heatmap      │   │
│  │  /api/sectors/rotation /api/sectors/correlation /api/sectors/kpl        │   │
│  │  /api/sectors/strongest /api/sectors/{code}/stocks /api/sectors/heat    │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                            │
│                                    ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          业务逻辑层                                       │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │   │
│  │  │  热度计算服务   │ │  轮动分析服务   │ │  关联分析服务   │              │   │
│  │  │  HeatService   │ │  RotationSvc   │ │  CorrelationSvc│              │   │
│  │  └────────────────┘ └────────────────┘ └────────────────┘              │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │   │
│  │  │  排行计算服务   │ │  资金流向服务   │ │  涨停统计服务   │              │   │
│  │  │  RankService   │ │  FundFlowSvc   │ │  LimitUpSvc    │              │   │
│  │  └────────────────┘ └────────────────┘ └────────────────┘              │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                            │
│                                    ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          数据访问层                                       │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │   │
│  │  │  sector_basic  │ │  sector_quote  │ │  sector_heat   │              │   │
│  │  │  板块基础信息   │ │  板块行情数据   │ │  板块热度表    │              │   │
│  │  └────────────────┘ └────────────────┘ └────────────────┘              │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │   │
│  │  │sector_rotation │ │sector_correlat │ │  kpl_concept   │              │   │
│  │  │  板块轮动记录   │ │  板块关联关系   │ │  开盘啦题材    │              │   │
│  │  └────────────────┘ └────────────────┘ └────────────────┘              │   │
│  │  ┌────────────────┐ ┌────────────────┐ ┌────────────────┐              │   │
│  │  │sector_stock_map│ │strongest_sector│ │ sector_fund_   │              │   │
│  │  │ 板块成分股关联  │ │  最强板块统计   │ │   flow 资金流  │              │   │
│  │  └────────────────┘ └────────────────┘ └────────────────┘              │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                    │                                            │
│                                    ▼                                            │
│  ┌─────────────────────────────────────────────────────────────────────────┐   │
│  │                          数据源层                                         │   │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │   │
│  │  │  ths_index   │ │  ths_daily   │ │  ths_member  │ │  ths_hot     │   │   │
│  │  │ 同花顺指数   │ │ 板块行情     │ │ 板块成分     │ │ 同花顺热榜   │   │   │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘   │   │
│  │  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐   │   │
│  │  │ kpl_concept  │ │kpl_concept_  │ │ limit_cpt_   │ │ stock_basic  │   │   │
│  │  │ 开盘啦题材   │ │   cons 成分  │ │   list 最强  │ │ 股票基础     │   │   │
│  │  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────────┘   │
│                                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 模块组件清单

### 前端组件

| 组件名称 | 功能描述 | 文件路径 |
|----------|----------|----------|
| SectorHeatmap | 板块热力图(Treemap) | components/SectorHeatmap.tsx |
| SectorRankList | 板块排行列表 | components/SectorRankList.tsx |
| SectorRotationChart | 轮动分析图表 | components/SectorRotationChart.tsx |
| SectorCorrelationGraph | 关联关系图谱 | components/SectorCorrelationGraph.tsx |
| FundFlowChart | 资金流向图 | components/FundFlowChart.tsx |
| KplConceptPanel | 开盘啦题材面板 | components/KplConceptPanel.tsx |
| StrongestSectorStats | 最强板块统计 | components/StrongestSectorStats.tsx |
| SectorDetailModal | 板块详情弹窗 | components/SectorDetailModal.tsx |
| HeatScoreIndicator | 热度指示器 | components/HeatScoreIndicator.tsx |

### 后端服务

| 服务名称 | 功能描述 | 文件路径 |
|----------|----------|----------|
| SectorService | 板块基础服务 | services/sector_service.py |
| HeatCalculationService | 热度计算服务 | services/heat_service.py |
| RotationAnalysisService | 轮动分析服务 | services/rotation_service.py |
| CorrelationService | 关联分析服务 | services/correlation_service.py |
| FundFlowService | 资金流向服务 | services/fundflow_service.py |
| LimitUpService | 涨停统计服务 | services/limitup_service.py |
| KplConceptService | 开盘啦题材服务 | services/kpl_service.py |

### 数据模型

| 模型名称 | 表名 | 说明 |
|----------|------|------|
| SectorBasic | sector_basic | 板块基础信息 |
| SectorQuote | sector_quote | 板块行情数据 |
| SectorHeat | sector_heat | 板块热度数据 |
| SectorRotation | sector_rotation | 板块轮动记录 |
| SectorCorrelation | sector_correlation | 板块关联关系 |
| SectorStockMap | sector_stock_map | 板块成分股关联 |
| KplConcept | kpl_concept_data | 开盘啦题材数据 |
| StrongestSector | strongest_sector_stats | 最强板块统计 |
| SectorFundFlow | sector_fund_flow | 板块资金流向 |

## 数据流图

```
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   Tushare   │────►│  数据同步   │────►│  数据清洗   │────►│  数据存储   │
│   数据源    │     │   服务      │     │   服务      │     │  (MySQL)    │
└─────────────┘     └─────────────┘     └─────────────┘     └──────┬──────┘
                                                                    │
                                                                    ▼
┌─────────────┐     ┌─────────────┐     ┌─────────────┐     ┌─────────────┐
│   前端展示   │◄────│   API服务   │◄────│  业务计算   │◄────│  数据查询   │
│  (React)    │     │  (FastAPI)  │     │   服务      │     │   服务      │
└─────────────┘     └─────────────┘     └─────────────┘     └─────────────┘
```

## 技术栈

| 层级 | 技术选型 |
|------|----------|
| 前端 | React + TypeScript + Ant Design + ECharts |
| 后端 | Python + FastAPI + SQLAlchemy |
| 数据库 | MySQL + Redis |
| 数据分析 | Pandas + NumPy + SciPy |
| 机器学习 | Scikit-learn (聚类分析) |
| 任务调度 | Celery + Redis |
| 缓存 | Redis |

---

*文档版本: 1.0*
